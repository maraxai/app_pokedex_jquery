var $pokemonRepository=(function(){var $pokemons=[];var $apiUrl='https://pokeapi.co/api/v2/pokemon/?limit=150';function addListItem(item){var $ul=$('ul');var $li=$('<li></li>');var $btn=$('<button></button>');$btn.addClass('listButton');$btn.text(item.name);$ul.append($li);$li.append($btn);$btn.on('click',function(){showDetails(item)})}
function showDetails(item){$pokemonRepository.loadDetails(item).then(function(){showModal(item.name,item.imageUrl,item.height,item.types)})}
function showModal(name,image,height,types){var $modalContainer=$('#modal-container');$modalContainer.addClass('is-visible');$modalContainer.html('');var $modal=$('<div></div>');$modal.addClass('modal');var $closeButtonElement=$('<button></button>');$closeButtonElement.addClass('modal-close');$closeButtonElement.text('close');$closeButtonElement.on('click',hideModal);var $contentNameElement=$('<h1></h1>');$contentNameElement.text(name);var $contentImageElement=$('<img>');$contentImageElement.attr('src',image);var $contentHeightElement=$('<p></p>');$contentHeightElement.text('height: '+height+' inches');var $contentTypesElement=$('<p></p>');$contentTypesElement.text('types: '+types);$modal.append($closeButtonElement);$modal.append($contentNameElement);$modal.append($contentImageElement);$modal.append($contentHeightElement);$modal.append($contentTypesElement);$modalContainer.append($modal)}
function hideModal(){var $modalContainer=$('#modal-container');$modalContainer.removeClass('is-visible')}
function add(item){$pokemons.push(item)}
function getAll(){return $pokemons}
function loadList(){return $.ajax($apiUrl).then(function(response){response.results.forEach(function(item){var $pokemon={name:item.name,detailsUrl:item.url,};add($pokemon)})}).catch(function(e){console.error(e)})}
function loadDetails(item){var $url=item.detailsUrl;return $.ajax($url).then(function(details){item.imageUrl=details.sprites.front_default;item.height=details.height;item.types=Object.keys(details.types)}).catch(function(e){console.error(e)})}
var $closeButtonElement=$('<button></button>');$closeButtonElement.addClass('modal-close');$closeButtonElement.text('close');$closeButtonElement.on('click',hideModal);$(window).on('keydown',e=>{var $modalContainer=$('#modal-container');if(e.key==='Escape'&&$modalContainer.hasClass('is-visible')){hideModal()}});var $modalContainer=$('#modal-container');$modalContainer.on('click',e=>{var target=e.target;if($(target).is($modalContainer)){hideModal()}});return{add:add,getAll:getAll,loadList:loadList,showDetails:showDetails,loadDetails:loadDetails,addListItem:addListItem,showModal:showModal,hideModal:hideModal,}})();$pokemonRepository.loadList().then(function(){$pokemonRepository.getAll().forEach(function($pokemon){$pokemonRepository.addListItem($pokemon)})})
